# 💪데이터베이스 텀 프로젝트 
## 프로젝트명 : 영화 예매 프로그램
* Java와 mysql을 연동하여 구현한 프로젝트
* Java로는 영화예매 프로그램의 각 화면(Jpanel과 JFrame)을 구현하고, mysql에 테이블과 관계를 설계(영화정보, 회원정보, 예약정보 등등)
* 스스로 테이블을 설계하고 스키마를 그려나가며 테이블 간의 관계를 만들어가며 구현한 프로젝트라는 점에서 큰 의의가 있다.

### 개요
1. 한학기 동안 배운 Mysql와 java를 연동하여 사용할 수 있는가?
2. 정규화와 무결성을 체크할 수 있는가?  
3. 테이블 간의 관계를 잘 이해하고 나타낼 수 있는가? 

### 스키마
![adfwf](https://user-images.githubusercontent.com/60773356/108061777-243b3080-709c-11eb-8a2c-aeaa8b92fe26.PNG)


#### person테이블의 데이터 삽입 / 수정 / 삭제
* 회원가입을 통해 JTextField를 getText()하여 그 값을 person 테이블로 insert, 아이디의 중복체크를 통해 중복 방지.
* 회원 정보 수정을 통해 정보를 수정하거나 회원탈퇴 가능.

#### movie테이블의 삽입 / 수정 / 삭제
* movie테이블의 영화정보를 누구나 수정할 수 있다면, 큰 문제가 되므로 특정한 관리자만 수정/추가/삭제를 할 수 있게 함. 
* 또한 관리자는 따로 회원가입 불가. 직접 승인받은 사람만 mysql을 통해 등록.

#### reservation_info테이블의 삽입 / 수정 / 삭제
* 영화와 시간을 선택하고, 인원 수와 자석을 선택한 후, 결제를 완료하면 insert.
* 예매 정보에서 예매 취소가 가능.

#### cgv테이블의 삽입 / 수정 / 삭제
* movie와 마찬가지로 관리자만 허용.

#### 영화의 예매율
* movie 테이블의 영화 제목과 예매율을 출력하여 JList에 담는데, 같은 영화이지만 다른 시간대인 영화가 있을 수 있으므로 DISTINCT 함수를 사용하여 예매율이 높은 순서대로 출력함.

#### 영화의 예고편
* 파워포인트와 같이 하이퍼링크를 자바에 달아서 버튼을 누르면 그 영화에 대한 예고편을 띄우게하면 어떨까란 생각을 함. 
* 메소드를 찾아보다가 런타임의 exec라는 메소드를 쓰면 하이퍼링크와 같은 기능을 할 수 있다는 것을 발견했음.
* 외부 클래스로 만든 후 객체화 시켜 특정버튼이 눌리면 그 버튼에 대한 예고편의 띄워주게함.

#### 가까운 영화관
* 로그인한 사람의 주소를 person테이블에서 가져옴. 그 주소를 cgv테이블의 cgv주소 칼럼과 매칭시켜줌. 
* LIKE문을 사용하여 근처 영화관을 추천해줌.

#### 좌석 선택 기능
* 가로8칸, 세로6칸의 총 48개의 버튼을 GridLayout을 통해 만듦. 인원 수를 입력 받는데, 버튼을 선택할 때 max_select의 값이 1씩 증가함. 
* 만약 max_select가 입력받은 인원 수 보다 크면 에러 메시지가 뜸.

#### 이미 예매된 좌석 선택 불가 기능
* 예매 완료를 하면 already_reserv 테이블에 예매한 사람과 예매한 좌석 정보가 들어감. 
* 좌석 선택 버튼을 띄울 때 already_reserv테이블의 이미 예매된 좌석 번호를 가져와서, 그 번호의 버튼은 enabled(false)해줌.

#### admin테이블의 각각의 관리자의 boss를 입력(관리자들 중에서도 직급에 따른 권한이 나누어짐)
* 수업시간에 배운 셀프조인을 이용하여 같은 테이블에 있는 admin_id를 통해 그 정보를 가져옴.

#### 영화, cgv, 나의 예매내역은 출력과 미리보기 가능.
* 교수님께서 제공하신 샘플소스에서 필요한 기능만 출력과, 미리보기 가능케 함.

#### 회원정보는 관리자만 볼 수 있음, 관리자의 정보는 boss인 ‘손민철‘만 볼 수 있음.

#### 아이디/비밀번호 찾기
* 프로그램에서 특정한 정보를 요구, 그 정보를 통해 데이터 베이스에 저장된 아이디와 비밀번호를 찾아서 알려줌.

#### 나의 예매정보
* 로그인한 사람의 정보로 reservation_info와 already_reserv의 예매 정보를 가져와서 출력.

#### 개봉예정영화
* 현재의 movie에 들어가 있는 영화는 모두 개봉한 영화라는 가정. 
* 새로 추가하는 영화는 아직 개봉하지 않은 개봉예정영화라는 가정.
* 만약 관리자 계정으로 새로운 영화와 개봉일을 추가하면, mysql에 저장되며, 자바에서는 SimpleDateFormat 클래스를 통해 현재 날짜를 저장하고, mysql의 movie테이블에서의 영화 중 개봉일이 현재 날짜 이후인 영화만 가져와 Jlist에 담아 출력함. 
* compareTo 메소드 사용해 날짜 비교
* 예매율을 가져올 때도 현재날짜보다 개봉일이 이전인 영화의 예매율만 가져옴, 이후의 영화는 개봉을 아직 안했으므로 예매율이 없음.





### **약 1년 3개월이 지난 후, 내 프로젝트를 바라보는 시선**
* 해당 프로젝트는 평가용이었기에 똑같은 컴퓨터에서 오로지 java 클래스와 mysql만을 사용해야한다는 제약이 있었다.
* 그렇기에 정말 무식하게 하나하나 모든 것을 일일히 구현했다. (layout도 직접 width, height값을 줘가며 구현 ㅋㅋ)
* 노다가(?)같은 프로젝트였지만 이것이 다 경험이었고 나에게 좋은 영양분이었다고 생각한다.
* Jpanel에 그리는 것이 아닌 spring을 통하여 직접 webserver를 구동시키고 그 위에 템플릿 엔진으로 쭉쭉 그려나가면 얼마나 깔끔하고 좋았을까 싶다 ㅋㅋㅋ

#### 다시 비슷한 프로젝트를 만든다면?
* 내가 알기로는 박스오피스 api 즉, 현재 상영 중인 영화에 대한 공공 데이터를 제공하는 것으로 알고있다.
* 이런 data를 현재 내가 배우고 있는 springboot를 통해 JSON형태로 전달받는다면 훨씬 현실감있을 것이라 생각된다.
* 위에서 언급했던 것처럼 View같은 부분들은 bootstrap이나 템플릿엔진 등으로 훨씬 효율적으로 작성할 수 있다.














